ImportPackage("system")
ImportPackage("windows")
ImportPackage("conio")
SetConsoleTitle("Get Foreground Window Name")

Print("Delay time in milliseconds: ")
local sleep_time = tonumber(GetInput())
sleep_time = sleep_time * 100000
while(true)
do
local first_ptr_hwnd,second_ptr_hwnd = GetForegroundWindow()
PickWindow(first_ptr_hwnd,second_ptr_hwnd)
local name = GetWindowName()
local class = GetClassName()
Println("name @" .. name .. "@ class @" .. class .."@")
Sleep(sleep_time)
end